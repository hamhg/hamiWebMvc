<?xml version='1.0' encoding='utf-8'?>
<Statement version='1'>

<sql id='DEF_USERS_BY_USERNAME_QUERY'><![CDATA[
SELECT USERNAME,PASSWORD,ENABLED
  FROM USERS
 WHERE USERNAME = ?
]]></sql>

<sql id='DEF_AUTHORITIES_BY_USERNAME_QUERY'><![CDATA[
SELECT USERNAME,AUTHORITY
  FROM AUTHORITIES
 WHERE USERNAME = ?
]]></sql>

<sql id='DEF_GROUP_AUTHORITIES_BY_USERNAME_QUERY'><![CDATA[
SELECT G.ID, G.GROUP_NAME, GA.AUTHORITY
  FROM GROUPS G, GROUP_MEMBERS GM, GROUP_AUTHORITIES GA
 WHERE GM.USERNAME = ?
   AND G.ID = GA.GROUP_ID
   AND G.ID = GM.GROUP_ID
]]></sql>

<sql id='DEF_CREATE_USER_SQL'><![CDATA[
INSERT INTO USERS (USERID, PASSWORD, ENABLED) VALUES (?,?,?)
]]></sql>

<sql id='DEF_DELETE_USER_SQL'><![CDATA[
DELETE FROM USERS WHERE USERID = ?
]]></sql>

<sql id='DEF_UPDATE_USER_SQL'><![CDATA[
UPDATE USERS SET PASSWORD = ?, ENABLED = ? WHERE USERID = ?
]]></sql>

<sql id='DEF_INSERT_AUTHORITY_SQL'><![CDATA[
INSERT INTO AUTHORITIES (USERID, AUTHORITY) VALUES (?,?)
]]></sql>

<sql id='DEF_DELETE_USER_AUTHORITIES_SQL'><![CDATA[
DELETE FROM AUTHORITIES WHERE USERID = ?
]]></sql>

<sql id='DEF_USER_EXISTS_SQL'><![CDATA[
SELECT USERID FROM USERS WHERE USERID = ?
]]></sql>

<sql id='DEF_CHANGE_PASSWORD_SQL'><![CDATA[
UPDATE USERS SET PASSWORD = ? WHERE USERID = ?
]]></sql>

<sql id='DEF_INSERT_AUTHORITY_SQL'><![CDATA[
INSERT INTO AUTHORITIES (USERID, AUTHORITY) VALUES (?,?)
]]></sql>

<sql id='DEF_FIND_GROUPS_SQL'><![CDATA[
SELECT GROUP_NAME FROM GROUPS
]]></sql>

<sql id='DEF_FIND_USERS_IN_GROUP_SQL'><![CDATA[
SELECT USERID FROM GROUP_MEMBERS GM, GROUPS G WHERE GM.GROUP_ID = G.ID  AND G.GROUP_NAME = ?
]]></sql>

<sql id='DEF_INSERT_GROUP_SQL'><![CDATA[
INSERT INTO GROUPS (GROUP_NAME) VALUES (?)
]]></sql>

<sql id='DEF_FIND_GROUP_ID_SQL'><![CDATA[
SELECT ID FROM GROUPS WHERE GROUP_NAME = ?
]]></sql>

<sql id='DEF_INSERT_GROUP_AUTHORITY_SQL'><![CDATA[
INSERT INTO GROUP_AUTHORITIES (GROUP_ID, AUTHORITY) VALUES (?,?)
]]></sql>

<sql id='DEF_DELETE_GROUP_SQL'><![CDATA[
DELETE FROM GROUPS WHERE ID = ?
]]></sql>

<sql id='DEF_DELETE_GROUP_AUTHORITIES_SQL'><![CDATA[
DELETE FROM GROUP_AUTHORITIES WHERE GROUP_ID = ?
]]></sql>

<sql id='DEF_DELETE_GROUP_MEMBERS_SQL'><![CDATA[
DELETE FROM GROUP_MEMBERS WHERE GROUP_ID = ?
]]></sql>

<sql id='DEF_RENAME_GROUP_SQL'><![CDATA[
UPDATE GROUPS SET GROUP_NAME = ? WHERE GROUP_NAME = ?
]]></sql>

<sql id='DEF_INSERT_GROUP_MEMBER_SQL'><![CDATA[
INSERT INTO GROUP_MEMBERS (GROUP_ID, USERID) VALUES (?,?)
]]></sql>

<sql id='DEF_DELETE_GROUP_MEMBER_SQL'><![CDATA[
DELETE FROM GROUP_MEMBERS WHERE GROUP_ID = ? AND USERID = ?
]]></sql>

<sql id='DEF_GROUP_AUTHORITIES_QUERY_SQL'><![CDATA[
SELECT G.ID, G.GROUP_NAME, GA.AUTHORITY
  FROM GROUPS G, GROUP_AUTHORITIES GA
 WHERE G.GROUP_NAME = ?
   AND G.ID = GA.GROUP_ID
]]></sql>

<sql id='DEF_DELETE_GROUP_AUTHORITY_SQL'><![CDATA[
DELETE FROM GROUP_AUTHORITIES WHERE GROUP_ID = ? AND AUTHORITY = ?
]]></sql>

</Statement>